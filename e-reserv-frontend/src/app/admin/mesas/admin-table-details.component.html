<div class="page">
  <div class="breadcrumbs">
    <span class="crumb" (click)="back()">/ Mesas</span>
    <span class="sep">/</span>
    <span class="crumb">Detalhes da Mesa</span>
    <span class="sep">/</span>
    <span class="crumb strong">Mesa {{ table?.number }}</span>
  </div>

  <div class="header-row">
    <h1 class="title">Mesa {{ table?.number }}</h1>
    <div class="actions">
      <ng-container *ngIf="!isEditing; else mesaEditingBtns">
        <button mat-stroked-button color="primary" (click)="startEdit()">Editar mesa</button>
        <button mat-raised-button color="warn">Excluir mesa</button>
      </ng-container>
      <ng-template #mesaEditingBtns>
        <button mat-raised-button color="primary" (click)="saveEdit()">Salvar</button>
        <button mat-stroked-button (click)="cancelEdit()">Cancelar</button>
      </ng-template>
    </div>
  </div>

  <div class="status-banner" [class.confirmed]="statusClass.disp" [class.cancelled]="statusClass.ocup" [class.pending]="statusClass.res">
    <mat-icon>table_bar</mat-icon>
    <div>
      <div class="b-title">Status da Mesa</div>
      <div *ngIf="statusClass.disp">Esta mesa está disponível para uso.</div>
      <div *ngIf="statusClass.ocup">Esta mesa está ocupada no momento.</div>
      <div *ngIf="statusClass.res">Esta mesa está reservada.</div>
    </div>
  </div>

  <div class="grid">
    <div class="left">
      <div class="card">
        <div class="card-title"><mat-icon>info</mat-icon>Informações da mesa</div>
        <div class="info-grid">
          <div class="kv">
            <span>Número</span>
            <ng-container *ngIf="!isEditing; else numEdit"><b>{{ table?.number }}</b></ng-container>
            <ng-template #numEdit><input type="number" [(ngModel)]="draft.number"></ng-template>
          </div>
          <div class="kv">
            <span>Assentos</span>
            <ng-container *ngIf="!isEditing; else chairsEdit"><b>{{ table?.chairs }}</b></ng-container>
            <ng-template #chairsEdit><input type="number" [(ngModel)]="draft.chairs"></ng-template>
          </div>
          <div class="kv">
            <span>Área</span>
            <ng-container *ngIf="!isEditing; else areaEdit"><b>{{ table?.area }}</b></ng-container>
            <ng-template #areaEdit><input [(ngModel)]="draft.area"></ng-template>
          </div>
          <div class="kv">
            <span>Status</span>
            <ng-container *ngIf="!isEditing; else statusEdit">
              <b class="tag" [class.green]="statusClass.disp" [class.red]="statusClass.ocup" [class.orange]="statusClass.res">{{ table?.status }}</b>
            </ng-container>
            <ng-template #statusEdit>
              <select [(ngModel)]="draft.status">
                <option>Disponível</option>
                <option>Ocupada</option>
                <option>Reservada</option>
              </select>
            </ng-template>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title"><mat-icon>person</mat-icon>Cliente atual</div>
        <div class="info-grid">
          <div class="kv">
            <span>Nome</span>
            <ng-container *ngIf="!isEditing; else nameEdit"><b>{{ table?.name || '-' }}</b></ng-container>
            <ng-template #nameEdit><input [(ngModel)]="draft.name"></ng-template>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-title"><mat-icon>edit</mat-icon>Observações</div>
        <div class="notes" *ngIf="!isEditing">{{ table?.notes || '—' }}</div>
        <textarea class="notes" *ngIf="isEditing" [(ngModel)]="draft.notes"></textarea>
      </div>
    </div>

    <div class="right">
      <div class="card side">
        <div class="side-title"><mat-icon>bolt</mat-icon>Ações Rápidas</div>
        <button mat-stroked-button color="primary" class="side-btn" (click)="marcarDisponivel()"><mat-icon>task_alt</mat-icon>Marcar como disponível</button>
        <button mat-stroked-button class="side-btn" (click)="marcarOcupada()"><mat-icon>event_seat</mat-icon>Marcar como ocupada</button>
        <button mat-stroked-button class="side-btn" (click)="marcarReservada()"><mat-icon>bookmark</mat-icon>Marcar como reservada</button>
      </div>

      <div class="card side">
        <div class="side-title"><mat-icon>history</mat-icon>Histórico</div>
        <div class="history-item">
          <mat-icon>event</mat-icon>
          <div>
            <div class="h-date">Hoje</div>
            <div>Mudança de status exibida como exemplo</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
